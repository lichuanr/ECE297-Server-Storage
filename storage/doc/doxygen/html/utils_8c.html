<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ECE297 Storage Server: utils.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ECE297 Storage Server
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">utils.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file implements various utility functions that are can be used by the storage server and client library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br/>
</div>
<p><a href="utils_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2855c16c86a59784935881e20e7c8d0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a2855c16c86a59784935881e20e7c8d0a">ModifyString2</a> (char *char_source)</td></tr>
<tr class="memdesc:a2855c16c86a59784935881e20e7c8d0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used for removing spaces.  <a href="#a2855c16c86a59784935881e20e7c8d0a"></a><br/></td></tr>
<tr class="memitem:a1af021305f04b73e72fa310c2daf1f0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a1af021305f04b73e72fa310c2daf1f0a">TestingStringCorrectness</a> (char *char_array_tested)</td></tr>
<tr class="memdesc:a1af021305f04b73e72fa310c2daf1f0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used for testing the validity of the line.  <a href="#a1af021305f04b73e72fa310c2daf1f0a"></a><br/></td></tr>
<tr class="memitem:a73c4a410d877b6a9358c547786f2102c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a73c4a410d877b6a9358c547786f2102c">sendall</a> (const int sock, const char *buf, const size_t len)</td></tr>
<tr class="memdesc:a73c4a410d877b6a9358c547786f2102c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used for sending data through the socket.  <a href="#a73c4a410d877b6a9358c547786f2102c"></a><br/></td></tr>
<tr class="memitem:ab126c8228ad72abbaed5f282709446ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ab126c8228ad72abbaed5f282709446ab">recvline</a> (const int sock, char *buf, const size_t buflen)</td></tr>
<tr class="memdesc:ab126c8228ad72abbaed5f282709446ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive an entire line from a socket.  <a href="#ab126c8228ad72abbaed5f282709446ab"></a><br/></td></tr>
<tr class="memitem:a2459e03c24825dd78defd1023487af3e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a2459e03c24825dd78defd1023487af3e">process_config_line</a> (char *line, struct <a class="el" href="structconfig__params.html">config_params</a> *params)</td></tr>
<tr class="memdesc:a2459e03c24825dd78defd1023487af3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse and process a line in the config file.  <a href="#a2459e03c24825dd78defd1023487af3e"></a><br/></td></tr>
<tr class="memitem:ae885a5871d260ab51ce6a9156f41f07e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#ae885a5871d260ab51ce6a9156f41f07e">read_config</a> (const char *config_file, struct <a class="el" href="structconfig__params.html">config_params</a> *params)</td></tr>
<tr class="memdesc:ae885a5871d260ab51ce6a9156f41f07e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and load configuration parameters.  <a href="#ae885a5871d260ab51ce6a9156f41f07e"></a><br/></td></tr>
<tr class="memitem:a9e4d8cb085fc7d5c9093ee102fa886d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#a9e4d8cb085fc7d5c9093ee102fa886d1">logger</a> (FILE *<a class="el" href="utils_8h.html#a702945180aa732857b380a007a7e2a21">file</a>, char *message)</td></tr>
<tr class="memdesc:a9e4d8cb085fc7d5c9093ee102fa886d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a log message.  <a href="#a9e4d8cb085fc7d5c9093ee102fa886d1"></a><br/></td></tr>
<tr class="memitem:aa26d27a9072e93c052cb0c7fca7909f7"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="utils_8c.html#aa26d27a9072e93c052cb0c7fca7909f7">generate_encrypted_password</a> (const char *passwd, const char *salt)</td></tr>
<tr class="memdesc:aa26d27a9072e93c052cb0c7fca7909f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates an encrypted password string using salt CRYPT_SALT.  <a href="#aa26d27a9072e93c052cb0c7fca7909f7"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This file implements various utility functions that are can be used by the storage server and client library. </p>
<p>Most of the functions in this file have different utilities, while can be used by server side or client side in order to connect with each other, send data, read configuration file, process configuration file and generate encrypted password for security purpose </p>

<p>Definition in file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>
</div><h2>Function Documentation</h2>
<a class="anchor" id="aa26d27a9072e93c052cb0c7fca7909f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* generate_encrypted_password </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>passwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>salt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates an encrypted password string using salt CRYPT_SALT. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">passwd</td><td>Password before encryption. </td></tr>
    <tr><td class="paramname">salt</td><td>Salt used to encrypt the password. If NULL default value DEFAULT_CRYPT_SALT is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns encrypted password. </dd></dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00627">627</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00152">DEFAULT_CRYPT_SALT</a>.</p>

<p>Referenced by <a class="el" href="encrypt__passwd_8c_source.html#l00030">main()</a>, and <a class="el" href="storage_8c_source.html#l00131">storage_auth()</a>.</p>

</div>
</div>
<a class="anchor" id="a9e4d8cb085fc7d5c9093ee102fa886d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void logger </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a log message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The output stream </td></tr>
    <tr><td class="paramname">message</td><td>Message to log. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00611">611</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="server_8c_source.html#l01057">main()</a>, <a class="el" href="storage_8c_source.html#l00131">storage_auth()</a>, <a class="el" href="storage_8c_source.html#l00488">storage_disconnect()</a>, <a class="el" href="storage_8c_source.html#l00198">storage_get()</a>, <a class="el" href="storage_8c_source.html#l00536">storage_query()</a>, and <a class="el" href="storage_8c_source.html#l00348">storage_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a2855c16c86a59784935881e20e7c8d0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ModifyString2 </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>char_source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used for removing spaces. </p>
<p>When a string be passed inside this function ( pass by parameter), the spaces inside this string will be get removed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">char_source</td><td>The string which contain spaces about to be removed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00034">34</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00141">process_config_line()</a>, and <a class="el" href="storage_8c_source.html#l00536">storage_query()</a>.</p>

</div>
</div>
<a class="anchor" id="a2459e03c24825dd78defd1023487af3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int process_config_line </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structconfig__params.html">config_params</a> *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse and process a line in the config file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line</td><td>Containing a line of strings </td></tr>
    <tr><td class="paramname">params</td><td>Containing the data taken from configuration file </td></tr>
  </table>
  </dd>
</dl>
<p>char ColumnNameArray[MAX_COLNAME_LEN*MAX_COLUMNS_PER_TABLE]; ///For storing each column name inside char ColumnTypeArray[MAX_COLNAME_LEN*MAX_COLUMNS_PER_TABLE]; ///For storing each column type inside</p>
<p>printf("column2: %s \n\n", token2); </p>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00141">141</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="utils_8h_source.html#l00095">config_params::concurrency</a>, <a class="el" href="server_8c_source.html#l00048">MAX_COLNAME_LEN</a>, <a class="el" href="server_8c_source.html#l00047">MAX_COLUMNS_PER_TABLE</a>, <a class="el" href="server_8c_source.html#l00032">MAX_CONFIG_LINE_LEN</a>, <a class="el" href="server_8c_source.html#l00049">MAX_STRTYPE_SIZE</a>, <a class="el" href="server_8c_source.html#l00040">MAX_TABLES</a>, <a class="el" href="utils_8c_source.html#l00034">ModifyString2()</a>, <a class="el" href="utils_8h_source.html#l00091">config_params::password</a>, <a class="el" href="utils_8h_source.html#l00082">config_params::server_host</a>, <a class="el" href="utils_8h_source.html#l00085">config_params::server_port</a>, <a class="el" href="utils_8c_source.html#l00057">TestingStringCorrectness()</a>, and <a class="el" href="utils_8h_source.html#l00088">config_params::username</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00558">read_config()</a>.</p>

</div>
</div>
<a class="anchor" id="ae885a5871d260ab51ce6a9156f41f07e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_config </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>config_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structconfig__params.html">config_params</a> *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read and load configuration parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config_file</td><td>The name of the configuration file. </td></tr>
    <tr><td class="paramname">params</td><td>The structure where config parameters are loaded. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return 0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00558">558</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>References <a class="el" href="storage_8c_source.html#l00041">file</a>, <a class="el" href="server_8c_source.html#l00032">MAX_CONFIG_LINE_LEN</a>, <a class="el" href="utils_8h_source.html#l00091">config_params::password</a>, <a class="el" href="utils_8c_source.html#l00141">process_config_line()</a>, <a class="el" href="utils_8h_source.html#l00082">config_params::server_host</a>, <a class="el" href="utils_8h_source.html#l00085">config_params::server_port</a>, and <a class="el" href="utils_8h_source.html#l00088">config_params::username</a>.</p>

<p>Referenced by <a class="el" href="server_8c_source.html#l01057">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ab126c8228ad72abbaed5f282709446ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int recvline </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive an entire line from a socket. </p>
<dl class="section return"><dt>Returns</dt><dd>Return 0 on success, -1 otherwise</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>The socket which will be used </td></tr>
    <tr><td class="paramname">buf</td><td>A buffer for storing string inside </td></tr>
    <tr><td class="paramname">buflen</td><td>The length of the buffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00106">106</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="server_8c_source.html#l01057">main()</a>, <a class="el" href="storage_8c_source.html#l00131">storage_auth()</a>, <a class="el" href="storage_8c_source.html#l00198">storage_get()</a>, <a class="el" href="storage_8c_source.html#l00536">storage_query()</a>, and <a class="el" href="storage_8c_source.html#l00348">storage_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a73c4a410d877b6a9358c547786f2102c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sendall </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used for sending data through the socket. </p>
<p>Keep sending the contents of the buffer until complete.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>The socket number </td></tr>
    <tr><td class="paramname">buf</td><td>The buf for characters </td></tr>
    <tr><td class="paramname">len</td><td>The length of the characters with type const size_t </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00080">80</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="storage_8c_source.html#l00131">storage_auth()</a>, <a class="el" href="storage_8c_source.html#l00198">storage_get()</a>, <a class="el" href="storage_8c_source.html#l00536">storage_query()</a>, and <a class="el" href="storage_8c_source.html#l00348">storage_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a1af021305f04b73e72fa310c2daf1f0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TestingStringCorrectness </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>char_array_tested</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used for testing the validity of the line. </p>
<p>This function is used for testing whether a string has a right format</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">char_array_tested</td><td>The string to be tested </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="utils_8c_source.html#l00057">57</a> of file <a class="el" href="utils_8c_source.html">utils.c</a>.</p>

<p>Referenced by <a class="el" href="utils_8c_source.html#l00141">process_config_line()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Apr 5 2014 19:02:51 for ECE297 Storage Server by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
